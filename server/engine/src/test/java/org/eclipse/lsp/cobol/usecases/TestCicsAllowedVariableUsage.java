/*
 * Copyright (c) 2023 Broadcom.
 * The term "Broadcom" refers to Broadcom Inc. and/or its subsidiaries.
 *
 * This program and the accompanying materials are made
 * available under the terms of the Eclipse Public License 2.0
 * which is available at https://www.eclipse.org/legal/epl-2.0/
 *
 * SPDX-License-Identifier: EPL-2.0
 *
 * Contributors:
 *    Broadcom, Inc. - initial API and implementation
 *
 */
package org.eclipse.lsp.cobol.usecases;

import com.google.common.collect.ImmutableList;
import com.google.common.collect.ImmutableMap;
import org.eclipse.lsp.cobol.test.engine.UseCaseEngine;
import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.MethodSource;

import java.util.stream.Stream;

/** Test the allowed variable usage */
public class TestCicsAllowedVariableUsage {
  public static final String TEXT =
      "       Identification Division.\n"
          + "       Program-id. HELLOT.\n"
          + "\n"
          + "       Data Division.\n"
          + "       Working-Storage Section.\n"
          + "\n"
          + "       01 {$*JSON-WORK-VARIABLES}.\n"
          + "           02 {$*CICS-RESP} PIC S9(8) COMP.\n"
          + "           02 {$*CICS-RESP2} PIC S9(8) COMP.\n"
          + "           02 {$*%s} PIC S9(8) COMP.\n"
          + "           02 {$*WS-URIMAP} PIC S9(8) COMP.\n"
          + "           02 {$*HOST-CODE-PAGE} PIC S9(8) COMP.\n"
          + "\n"
          + "\n"
          + "       Procedure Division.\n"
          + "\n"
          + "           EXEC CICS\n"
          + "               WEB OPEN\n"
          + "               URIMAP({$WS-URIMAP})\n"
          + "               CODEPAGE({$HOST-CODE-PAGE})\n"
          + "               SESSTOKEN({$%s})\n"
          + "               RESP({$CICS-RESP})\n"
          + "               RESP2({$CICS-RESP2})\n"
          + "           END-EXEC.\n"
          + "       End program HELLOT.";

  private static Stream<String> getProgramToTest() {
    return ImmutableList.of(
            "ABCODE",
            "ABDUMP",
            "ABEND",
            "ABORT",
            "ABPROGRAM",
            "ABSTIME",
            "ACCUM",
            "ACEE",
            "ACQACTIVITY",
            "ACQPROCESS",
            "ACQUACTIVITY",
            "ACTION",
            "ACTIVITY",
            "ACTIVITYID",
            "ACTPARTN",
            "AID",
            "ALARM",
            "ALTSCRNHT",
            "ALTSCRNWD",
            "ANYKEY",
            "APLKYBD",
            "APLTEXT",
            "APPLID",
            "AS",
            "ASA",
            "ASIS",
            "ASKTIME",
            "ASRAINTRPT",
            "ASRAKEY",
            "ASRAPSW",
            "ASRAREGS",
            "ASRASPC",
            "ASRASTG",
            "ASYNCHRONOUS",
            "ATTACH",
            "ATTACHID",
            "ATTRIBUTES",
            "AUTHENTICATE",
            "AUTOPAGE",
            "AUXILIARY",
            "BASE64",
            "BASICAUTH",
            "BELOW",
            "BIF",
            "BODYCHARSET",
            "BOOKMARK",
            "BRDATA",
            "BRDATALENGTH",
            "BREXIT",
            "BRIDGE",
            "BROWSETOKEN",
            "BTRANS",
            "BUFFER",
            "BUILD",
            "BURGEABILITY",
            "CADDRLENGTH",
            "CARD",
            "CBUFF",
            "CCSID",
            "CERTIFICATE",
            "CHANGE",
            "CHANGETIME",
            "CHANNEL",
            "CHAR",
            "CHARACTERSET",
            "CHECK",
            "CHUNKEND",
            "CHUNKING",
            "CHUNKNO",
            "CHUNKYES",
            "CICSDATAKEY",
            "CIPHERS",
            "CLEAR",
            "CLICONVERT",
            "CLIENT",
            "CLIENTADDR",
            "CLIENTADDRNU",
            "CLIENTCONV",
            "CLIENTNAME",
            "CLNTADDR6NU",
            "CLNTIPFAMILY",
            "CLOSESTATUS",
            "CLRPARTN",
            "CMDSEC",
            "CNAMELENGTH",
            "CNOTCOMPL",
            "CODEPAGE",
            "COLOR",
            "COMMAREA",
            "COMMONNAME",
            "COMMONNAMLEN",
            "COMPAREMAX",
            "COMPAREMIN",
            "COMPLETE",
            "COMPOSITE",
            "COMPSTATUS",
            "CONFIRM",
            "CONFIRMATION",
            "CONNECT",
            "CONSISTENT",
            "CONSOLE",
            "CONTAINER",
            "CONTEXTTYPE",
            "CONVDATA",
            "CONVERSE",
            "CONVERTST",
            "CONVERTTIME",
            "CONVID",
            "COUNTER",
            "COUNTRY",
            "COUNTRYLEN",
            "CREATE",
            "CRITICAL",
            "CTLCHAR",
            "CURRENT",
            "CWA",
            "CWALENG",
            "DATA1",
            "DATA2",
            "DATALENGTH",
            "DATALENTH",
            "DATAONLY",
            "DATAPOINTER",
            "DATASET",
            "DATASTR",
            "DATATOXML",
            "DATATYPE",
            "DATCONTAINER",
            "DATEFORM",
            "DATESEP",
            "DATESTRING",
            "DAYCOUNT",
            "DAYOFMONTH",
            "DAYOFWEEK",
            "DAYOFYEAR",
            "DAYS",
            "DAYSLEFT",
            "DCOUNTER",
            "DDMMYY",
            "DDMMYYYY",
            "DEBKEY",
            "DEBREC",
            "DEEDIT",
            "DEFINE",
            "DEFRESP",
            "DEFSCRNHT",
            "DEFSCRNWD",
            "DELAY",
            "DELETEQ",
            "DEQ",
            "DESTCOUNT",
            "DESTID",
            "DESTIDLENG",
            "DETAILLENGTH",
            "DFHRESP",
            "DFHVALUE",
            "DIGEST",
            "DIGESTTYPE",
            "DISCONNECT",
            "DOCDELETE",
            "DOCSIZE",
            "DOCSTATUS",
            "DOCTOKEN",
            "DOCUMENT",
            "DS3270",
            "DSSCS",
            "DUMP",
            "DUMPCODE",
            "DUMPID",
            "DUPREC",
            "ECADDR",
            "ECBLIST",
            "EIB",
            "ELEMNAME",
            "ELEMNAMELEN",
            "ELEMNS",
            "ELEMNSLEN",
            "ENDACTIVITY",
            "ENDBR",
            "ENDBROWSE",
            "ENDFILE",
            "ENDOUTPUT",
            "ENQ",
            "ENTRYNAME",
            "EOC",
            "EODS",
            "EPRFIELD",
            "EPRFROM",
            "EPRINTO",
            "EPRLENGTH",
            "EPRSET",
            "EPRTYPE",
            "ERASE",
            "ERASEAUP",
            "ERRTERM",
            "ESMREASON",
            "ESMRESP",
            "EVENT",
            "EVENTTYPE",
            "EVENTUAL",
            "EWASUPP",
            "EXPECT",
            "EXPIRYTIME",
            "EXTDS",
            "EXTRACT",
            "FACILITY",
            "FACILITYTOKN",
            "FAULTACTLEN",
            "FAULTACTOR",
            "FAULTCODE",
            "FAULTCODELEN",
            "FAULTCODESTR",
            "FAULTSTRING",
            "FAULTSTRLEN",
            "FCI",
            "FCT",
            "FIELD",
            "FIRESTATUS",
            "FLENGTH",
            "FMH",
            "FMHPARM",
            "FORCE",
            "FORMATTIME",
            "FORMFEED",
            "FORMFIELD",
            "FREEKB",
            "FREEMAIN",
            "FROMACTIVITY",
            "FROMCCSID",
            "FROMCHANNEL",
            "FROMCODEPAGE",
            "FROMDOC",
            "FROMFLENGTH",
            "FROMLENGTH",
            "FROMPROCESS",
            "FRSET",
            "FULLDATE",
            "GCHARS",
            "GCODES",
            "GDS",
            "GENERIC",
            "GET",
            "GETMAIN",
            "GETNEXT",
            "GMMI",
            "GROUPID",
            "GTEQ",
            "HANDLE",
            "HEAD",
            "HEADER",
            "HEX",
            "HIGH_VALUE",
            "HIGH_VALUES",
            "HILIGHT",
            "HOLD",
            "HONEOM",
            "HOST",
            "HOSTCODEPAGE",
            "HOSTLENGTH",
            "HOSTTYPE",
            "HOURS",
            "HTTPHEADER",
            "HTTPMETHOD",
            "HTTPRNUM",
            "HTTPVERSION",
            "HTTPVNUM",
            "IGNORE",
            "IMMEDIATE",
            "INCREMENT",
            "INITIMG",
            "INITPARM",
            "INITPARMLEN",
            "INPARTN",
            "INPUTEVENT",
            "INPUTMSG",
            "INPUTMSGLEN",
            "INQUIRE",
            "INTEGER",
            "INTERVAL",
            "INTOCCSID",
            "INTOCODEPAGE",
            "INVALIDCOUNT",
            "INVITE",
            "INVMPSZ",
            "INVOKE",
            "INVOKINGPROG",
            "INVPARTN",
            "INVREQ",
            "ISSUE",
            "ISSUER",
            "ITEM",
            "IUTYPE",
            "JOURNALNAME",
            "JTYPEID",
            "JUSFIRST",
            "JUSLAST",
            "JUSTIFY",
            "KATAKANA",
            "KEEP",
            "KEYLENGTH",
            "KEYNUMBER",
            "L40",
            "L64",
            "L80",
            "LANGINUSE",
            "LANGUAGECODE",
            "LASTUSETIME",
            "LDC",
            "LDCMNEM",
            "LDCNUM",
            "LEAVEKB",
            "LENGTHLIST",
            "LEVEL",
            "LIGHTPEN",
            "LINAGE_COUNTER",
            "LINEADDR",
            "LINK",
            "LIST",
            "LISTLENGTH",
            "LLID",
            "LOAD",
            "LOCALITY",
            "LOCALITYLEN",
            "LOGMESSAGE",
            "LOGMODE",
            "LOGONLOGMODE",
            "LOGONMSG",
            "LOW_VALUE",
            "LOW_VALUES",
            "LUNAME",
            "MAIN",
            "MAP",
            "MAPCOLUMN",
            "MAPFAIL",
            "MAPHEIGHT",
            "MAPLINE",
            "MAPONLY",
            "MAPPED",
            "MAPPINGDEV",
            "MAPSET",
            "MAPWIDTH",
            "MASSINSERT",
            "MAXDATALEN",
            "MAXFLENGTH",
            "MAXIMUM",
            "MAXLENGTH",
            "MAXLIFETIME",
            "MAXPROCLEN",
            "MCC",
            "MEDIATYPE",
            "MESSAGEID",
            "METADATA",
            "METADATALEN",
            "METHODLENGTH",
            "MILLISECONDS",
            "MINIMUM",
            "MINUTES",
            "MMDDYY",
            "MMDDYYYY",
            "MODENAME",
            "MONITOR",
            "MONTH",
            "MONTHOFYEAR",
            "MSR",
            "MSRCONTROL",
            "NAME",
            "NAMELENGTH",
            "NATLANG",
            "NATLANGINUSE",
            "NETNAME",
            "NEWPASSWORD",
            "NEWPHRASE",
            "NEWPHRASELEN",
            "NEXTTRANSID",
            "NLEOM",
            "NOAUTOPAGE",
            "NOCC",
            "NOCHECK",
            "NOCLICONVERT",
            "NOCLOSE",
            "NODATA",
            "NODE",
            "NODOCDELETE",
            "NODUMP",
            "NOEDIT",
            "NOFLUSH",
            "NOHANDLE",
            "NOINCONVERT",
            "NONE",
            "NOOUTCONERT",
            "NOQUEUE",
            "NOQUIESCE",
            "NOSRVCONVERT",
            "NOSUSPEND",
            "NOTE",
            "NOTPURGEABLE",
            "NOTRUNCATE",
            "NOWAIT",
            "NSCONTAINER",
            "NUMCIPHERS",
            "NUMEVENTS",
            "NUMITEMS",
            "NUMREC",
            "NUMROUTES",
            "NUMSEGMENTS",
            "NUMTAB",
            "OIDCARD",
            "OPCLASS",
            "OPERATION",
            "OPERATOR",
            "OPERID",
            "OPERKEYS",
            "OPERPURGE",
            "OPID",
            "OPSECURITY",
            "OPTIONS",
            "ORGABCODE",
            "ORGANIZATLEN",
            "ORGUNIT",
            "ORGUNITLEN",
            "OUTDESCR",
            "OUTLINE",
            "OUTPARTN",
            "OWNER",
            "PA1",
            "PA2",
            "PA3",
            "PAGENUM",
            "PAGE_COUNTER",
            "PAGING",
            "PARSE",
            "PARTN",
            "PARTNER",
            "PARTNFAIL",
            "PARTNPAGE",
            "PARTNS",
            "PARTNSET",
            "PASS",
            "PASSBK",
            "PASSWORDLEN",
            "PATH",
            "PATHLENGTH",
            "PCT",
            "PF1",
            "PF10",
            "PF11",
            "PF12",
            "PF13",
            "PF14",
            "PF15",
            "PF16",
            "PF17",
            "PF18",
            "PF19",
            "PF2",
            "PF20",
            "PF21",
            "PF22",
            "PF23",
            "PF24",
            "PF3",
            "PF4",
            "PF5",
            "PF6",
            "PF7",
            "PF8",
            "PF9",
            "PFXLENG",
            "PHRASE",
            "PHRASELEN",
            "PIPLENGTH",
            "PIPLIST",
            "POINT",
            "POOL",
            "POP",
            "PORTNUMBER",
            "PORTNUMNU",
            "POST",
            "PPT",
            "PREDICATE",
            "PREFIX",
            "PREPARE",
            "PRINCONVID",
            "PRINSYSID",
            "PRINT",
            "PRIORITY",
            "PRIVACY",
            "PROCESS",
            "PROCESSTYPE",
            "PROCLENGTH",
            "PROCNAME",
            "PROFILE",
            "PROTECT",
            "PS",
            "PUNCH",
            "PURGEABLE",
            "PUSH",
            "PUT",
            "QNAME",
            "QUERY",
            "QUERYPARM",
            "QUERYSTRING",
            "QUERYSTRLEN",
            "RBA",
            "RBN",
            "RDATT",
            "READNEXT",
            "READPREV",
            "READQ",
            "REATTACH",
            "RECEIVER",
            "RECFM",
            "RECORDLEN",
            "RECORDLENGTH",
            "REDUCE",
            "REFPARMS",
            "REFPARMSLEN",
            "RELATESINDEX",
            "RELATESTYPE",
            "RELATESURI",
            "REMOVE",
            "REPEATABLE",
            "REPETABLE",
            "REPLY",
            "REPLYLENGTH",
            "REQID",
            "REQUESTTYPE",
            "RESCLASS",
            "RESETBR",
            "RESID",
            "RESIDLENGTH",
            "RESOURCE",
            "RESP",
            "RESP2",
            "RESSEC",
            "RESTART",
            "RESTYPE",
            "RESULT",
            "RESUME",
            "RETAIN",
            "RETCODE",
            "RETCORD",
            "RETRIECE",
            "RETRIEVE",
            "RETURNPROG",
            "RIDFLD",
            "ROLE",
            "ROLELENGTH",
            "ROLLBACK",
            "ROUTE",
            "ROUTECODES",
            "RPROCESS",
            "RRESOURCE",
            "RRN",
            "RTERMID",
            "RTRANSID",
            "SADDRLENGTH",
            "SCHEME",
            "SCHEMENAME",
            "SCOPE",
            "SCOPELEN",
            "SCRNHT",
            "SCRNWD",
            "SECONDS",
            "SEGMENTLIST",
            "SENDER",
            "SERIALNUM",
            "SERIALNUMLEN",
            "SERVER",
            "SERVERADDR",
            "SERVERADDRNU",
            "SERVERCONV",
            "SERVERNAME",
            "SESSION",
            "SESSTOKEN",
            "SHARED",
            "SIGDATA",
            "SIGNAL",
            "SIGNOFF",
            "SIGNON",
            "SIT",
            "SNAMELENGTH",
            "SOAPFAULT",
            "SOSI",
            "SPOOLCLOSE",
            "SPOOLOPEN",
            "SPOOLREAD",
            "SPOOLWRITE",
            "SRVCONVERT",
            "SRVRADDR6NU",
            "SRVRIPFAMILY",
            "SSLTYPE",
            "STARTBR",
            "STARTBROWSE",
            "STARTCODE",
            "STATE",
            "STATELEN",
            "STATIONID",
            "STATUSCODE",
            "STATUSLEN",
            "STATUSTEXT",
            "STORAGE",
            "STRFIELD",
            "STRINGFORMAT",
            "SUBADDR",
            "SUBCODELEN",
            "SUBCODESTR",
            "SUBEVENT",
            "SUBEVENT1",
            "SUBEVENT2",
            "SUBEVENT3",
            "SUBEVENT4",
            "SUBEVENT5",
            "SUBEVENT6",
            "SUBEVENT7",
            "SUBEVENT8",
            "SUSPEND",
            "SUSPSTATUS",
            "SYMBOL",
            "SYMBOLLIST",
            "SYNCHRONOUS",
            "SYNCLEVEL",
            "SYNCONRETURN",
            "SYNCPOINT",
            "SYSID",
            "TABLES",
            "TASK",
            "TASKPRIORITY",
            "TCPIP",
            "TCPIPSERVICE",
            "TCT",
            "TCTUA",
            "TCTUALENG",
            "TD",
            "TELLERID",
            "TEMPLATE",
            "TERMCODE",
            "TERMID",
            "TERMPRIORITY",
            "TEXTKYBD",
            "TEXTLENGTH",
            "TEXTPRINT",
            "TIMEOUT",
            "TIMER",
            "TIMESEP",
            "TOACTIVITY",
            "TOCHANNEL",
            "TOCONTAINER",
            "TOFLENGTH",
            "TOKEN",
            "TOLENGTH",
            "TOPROCESS",
            "TRACENUM",
            "TRAILER",
            "TRANPRIORITY",
            "TRANSACTION",
            "TRANSFORM",
            "TRANSID",
            "TRIGGER",
            "TRT",
            "TS",
            "TWA",
            "TWALENG",
            "TYPENAME",
            "TYPENAMELEN",
            "TYPENS",
            "TYPENSLEN",
            "UNATTEND",
            "UNCOMMITTED",
            "UNESCAPED",
            "UNEXPIN",
            "UNLOCK",
            "UOW",
            "UPDATE",
            "URI",
            "URIMAP",
            "URL",
            "URLLENGTH",
            "USERDATAKEY",
            "USERID",
            "USERNAME",
            "USERNAMELEN",
            "USERPRIORITY",
            "VALIDATION",
            "VALUELENGTH",
            "VERIFY",
            "VERSIONLEN",
            "VOLUME",
            "VOLUMELENG",
            "WAIT",
            "WAITCICS",
            "WEB",
            "WHEN_COMPILED",
            "WPMEDIA1",
            "WPMEDIA2",
            "WPMEDIA3",
            "WPMEDIA4",
            "WRAP",
            "WRITEQ",
            "WSACONTEXT",
            "WSAEPR",
            "XCTL",
            "XMLCONTAINER",
            "XMLTODATA",
            "XMLTRANSFORM",
            "XRBA",
            "YEAR",
            "YYDDD",
            "YYDDMM",
            "YYMMDD",
            "YYYYDDD",
            "YYYYDDMM",
            "YYYYMMDD")
        .stream()
        .map(str -> String.format(TEXT, str, str));
  }

  @ParameterizedTest
  @MethodSource("getProgramToTest")
  void test(String text) {
    UseCaseEngine.runTest(text, ImmutableList.of(), ImmutableMap.of());
  }
}
